"use strict";(globalThis.webpackChunksite=globalThis.webpackChunksite||[]).push([[421],{7076(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"reference/API","title":"Nodenberg API Documentation","description":"Pure Express API Server for Excel & PDF generation.","source":"@site/docs/reference/API.md","sourceDirName":"reference","slug":"/reference/API","permalink":"/api-pages/docs/reference/API","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Usage Notes","permalink":"/api-pages/docs/usage-notes"}}');var r=s(4848),i=s(8453);const d={},t="Nodenberg API Documentation",c={},a=[{value:"Base URL",id:"base-url",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Setup",id:"setup",level:3},{value:"Usage",id:"usage",level:3},{value:"Error Responses",id:"error-responses",level:3},{value:"Endpoints",id:"endpoints",level:2},{value:"1. Health Check",id:"1-health-check",level:3},{value:"2. Detect Placeholders",id:"2-detect-placeholders",level:3},{value:"3. Get Template Info",id:"3-get-template-info",level:3},{value:"4. Get Sheet List",id:"4-get-sheet-list",level:3},{value:"5. Validate Template",id:"5-validate-template",level:3},{value:"6. Generate Excel",id:"6-generate-excel",level:3},{value:"7. Generate Excel (By Display Order)",id:"7-generate-excel-by-display-order",level:3},{value:"8. Generate PDF",id:"8-generate-pdf",level:3},{value:"9. Generate PDF (By Display Order)",id:"9-generate-pdf-by-display-order",level:3},{value:"Error Responses",id:"error-responses-1",level:2},{value:"File Encoding",id:"file-encoding",level:2},{value:"Encoding a file (example in Node.js):",id:"encoding-a-file-example-in-nodejs",level:3},{value:"Decoding a response (example in Node.js):",id:"decoding-a-response-example-in-nodejs",level:3},{value:"Encoding a file (example in Python):",id:"encoding-a-file-example-in-python",level:3},{value:"Decoding a response (example in Python):",id:"decoding-a-response-example-in-python",level:3},{value:"Placeholder Format",id:"placeholder-format",level:2},{value:"Array (Table) placeholders",id:"array-table-placeholders",level:3},{value:"Section + Table placeholders (multi-row block)",id:"section--table-placeholders-multi-row-block",level:3},{value:"test9 Method",id:"test9-method",level:2},{value:"How it works:",id:"how-it-works",level:3},{value:"Multi-page Print Area (test13-like)",id:"multi-page-print-area-test13-like",level:2},{value:"Testing",id:"testing",level:2},{value:"CLI Test Suite",id:"cli-test-suite",level:3},{value:"GUI Test Client",id:"gui-test-client",level:3},{value:"Development",id:"development",level:2},{value:"Start development server (hot-reload):",id:"start-development-server-hot-reload",level:3},{value:"Build for production:",id:"build-for-production",level:3},{value:"Start production server:",id:"start-production-server",level:3},{value:"Initialize LibreOffice (for PDF generation):",id:"initialize-libreoffice-for-pdf-generation",level:3},{value:"Rate Limits",id:"rate-limits",level:2},{value:"CORS",id:"cors",level:2},{value:"Support",id:"support",level:2},{value:"Version",id:"version",level:2}];function o(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"nodenberg-api-documentation",children:"Nodenberg API Documentation"})}),"\n",(0,r.jsx)(n.p,{children:"Pure Express API Server for Excel & PDF generation."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Base placeholder replacement: ",(0,r.jsx)(n.strong,{children:"test9 method"})," (edit ",(0,r.jsx)(n.code,{children:"xl/sharedStrings.xml"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Table (array) expansion + multi-page print area: ",(0,r.jsx)(n.strong,{children:"test13-like behavior"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Legacy ",(0,r.jsx)(n.code,{children:"{{#array.field}}"})," and section-table ",(0,r.jsx)(n.code,{children:"{{##section.table.cell}}"})," are supported"]}),"\n",(0,r.jsx)(n.li,{children:"Section-table mode detects target sheet dynamically and expands multi-row record blocks"}),"\n",(0,r.jsxs)(n.li,{children:["If output exceeds the first print area by 1+ rows, appends the next print area with the same height","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Example: ",(0,r.jsx)(n.code,{children:"$A$1:$Q$40"})," \u2192 ",(0,r.jsx)(n.code,{children:"$A$1:$Q$40,$A$41:$Q$80"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"base-url",children:"Base URL"}),"\n",(0,r.jsx)(n.p,{children:"Local (dev):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"http://localhost:3000\n"})}),"\n",(0,r.jsx)(n.p,{children:"Docker (compose default):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"http://localhost:3200\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,r.jsxs)(n.p,{children:["API key authentication is ",(0,r.jsx)(n.strong,{children:"required"})," for all endpoints except ",(0,r.jsx)(n.code,{children:"/health"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Create a ",(0,r.jsx)(n.code,{children:".env"})," file in the project root (copy from ",(0,r.jsx)(n.code,{children:".env.example"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Set the ",(0,r.jsx)(n.code,{children:"API_KEY"})," environment variable:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"API_KEY=your-secret-api-key-here\n"})}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Restart the server"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Generate a secure API key:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Using openssl\nopenssl rand -hex 32\n\n# Or use a strong password generator\n"})}),"\n",(0,r.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,r.jsxs)(n.p,{children:["Include the API key in the ",(0,r.jsx)(n.code,{children:"X-API-Key"})," header for all requests:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -H "X-API-Key: your-secret-api-key-here" \\\n  http://localhost:3000/template/placeholders\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Important:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["API key is ",(0,r.jsx)(n.strong,{children:"required"})," for all endpoints except ",(0,r.jsx)(n.code,{children:"/health"})]}),"\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"API_KEY"})," is not configured, the server will return a 500 error"]}),"\n",(0,r.jsx)(n.li,{children:"Keep your API key secret and never commit it to version control"}),"\n",(0,r.jsx)(n.li,{children:"Use different keys for development and production"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Browser clients (CORS):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Preflight ",(0,r.jsx)(n.code,{children:"OPTIONS"})," requests are allowed without API key."]}),"\n",(0,r.jsxs)(n.li,{children:["Actual API requests still require ",(0,r.jsx)(n.code,{children:"X-API-Key"})," (except ",(0,r.jsx)(n.code,{children:"/health"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"error-responses",children:"Error Responses"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Unauthorized (401)"})," - Invalid or missing API key:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "error": "Unauthorized",\n  "message": "Valid API key required. Provide it in the X-API-Key header."\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Server Error (500)"})," - API key not configured on server:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "error": "Server Configuration Error",\n  "message": "API_KEY is not configured on the server. Please set API_KEY in .env file."\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,r.jsx)(n.h3,{id:"1-health-check",children:"1. Health Check"}),"\n",(0,r.jsx)(n.p,{children:"Check server status."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"GET /health"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:3000/health\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": "ok",\n  "timestamp": "2025-12-13T07:30:00.000Z",\n  "service": "Nodenberg API Server",\n  "version": "0.0.1"\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"2-detect-placeholders",children:"2. Detect Placeholders"}),"\n",(0,r.jsx)(n.p,{children:"Detect placeholders in Excel template."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /template/placeholders"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "templateBase64": "UEsDBBQABg...",\n  "detailed": false\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"templateBase64"})," (required): Base64-encoded Excel file"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"detailed"})," (optional): Return detailed placeholder information (default: false)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Simple Response (detailed: false):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "placeholders": ["\u4f1a\u793e\u540d", "\u8acb\u6c42\u65e5", "\u652f\u6255\u671f\u9650", "#\u660e\u7d30.\u756a\u53f7", "#\u660e\u7d30.\u9805\u76ee"]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Detailed Response (detailed: true):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "placeholders": [\n    {\n      "placeholder": "{{\u4f1a\u793e\u540d}}",\n      "key": "\u4f1a\u793e\u540d",\n      "count": 2\n    },\n    {\n      "placeholder": "{{#\u660e\u7d30.\u756a\u53f7}}",\n      "key": "#\u660e\u7d30.\u756a\u53f7",\n      "count": 9\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:3000/template/placeholders \\\n  -H "Content-Type: application/json" \\\n  -H "X-API-Key: your-api-key-here" \\\n  -d \'{\n    "templateBase64": "UEsDBBQABg...",\n    "detailed": true\n  }\'\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.em,{children:["Note: Omit the ",(0,r.jsx)(n.code,{children:"X-API-Key"})," header if authentication is not enabled."]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"3-get-template-info",children:"3. Get Template Info"}),"\n",(0,r.jsx)(n.p,{children:"Get template metadata (sheets, cells, etc.)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /template/info"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "templateBase64": "UEsDBBQABg..."\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "templateInfo": {\n    "sheetCount": 2,\n    "sheets": [\n      {\n        "id": 1,\n        "name": "Sheet1",\n        "rowCount": 0,\n        "columnCount": 0\n      },\n      {\n        "id": 2,\n        "name": "Sheet2",\n        "rowCount": 0,\n        "columnCount": 0\n      }\n    ]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:3000/template/info \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "templateBase64": "UEsDBBQABg..."\n  }\'\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"4-get-sheet-list",children:"4. Get Sheet List"}),"\n",(0,r.jsxs)(n.p,{children:["Get sheet list with display order, ",(0,r.jsx)(n.code,{children:"sheetId"}),", and sheet name."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /template/sheets"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "templateBase64": "UEsDBBQABg..."\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "sheetCount": 3,\n  "sheets": [\n    {\n      "displayOrder": 1,\n      "id": 1,\n      "name": "\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9\u8acb\u6c42\u66f8 \u5358\u4f4d\u3042\u308a 10\uff05"\n    },\n    {\n      "displayOrder": 2,\n      "id": 2,\n      "name": "\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9\u8acb\u6c42\u66f8 \u5358\u4f4d\u3042\u308a 10\uff05 _2"\n    },\n    {\n      "displayOrder": 3,\n      "id": 3,\n      "name": "\u53c2\u7167\u30b7\u30fc\u30c8"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:3000/template/sheets \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "templateBase64": "UEsDBBQABg..."\n  }\'\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"5-validate-template",children:"5. Validate Template"}),"\n",(0,r.jsx)(n.p,{children:"Validate template payload and optionally generate JSON template."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /template/validate"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "templateId": "invoice-v1",\n  "templateName": "\u8acb\u6c42\u66f8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8",\n  "base64Data": "UEsDBBQABg...",\n  "generateJsonTemplate": true\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"templateId"})," (required): Template identifier (string)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"templateName"})," (required): Human-readable name (string)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"base64Data"})," (required): Base64-encoded Excel file"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"generateJsonTemplate"})," (optional): Generate a JSON template by reading the workbook via ExcelJS (default: false)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "template": {\n    "id": "invoice-v1",\n    "name": "\u8acb\u6c42\u66f8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8",\n    "uploadedAt": "2025-12-14T11:00:00.000Z",\n    "hasJsonTemplate": true\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:3000/template/validate \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "templateId": "invoice-v1",\n    "templateName": "\u8acb\u6c42\u66f8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8",\n    "base64Data": "UEsDBBQABg...",\n    "generateJsonTemplate": true\n  }\'\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Compatibility note:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /template/upload"})," is kept as a backward-compatible alias and is deprecated."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"6-generate-excel",children:"6. Generate Excel"}),"\n",(0,r.jsx)(n.p,{children:"Generate Excel file by replacing placeholders with data."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /generate/excel"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "templateBase64": "UEsDBBQABg...",\n  "data": {\n    "\u62c5\u5f53\u8005": "\u5c71\u7530\u592a\u90ce",\n    "\u4f1a\u793e\u540d": "\u30c6\u30b9\u30c8\u682a\u5f0f\u4f1a\u793e",\n    "\u8acb\u6c42\u65e5": "2025\u5e7412\u67081\u65e5",\n    "\u652f\u6255\u671f\u9650": "2025\u5e7412\u670831\u65e5",\n    "\u660e\u7d30": [\n      { "\u756a\u53f7": 1, "\u9805\u76ee": "Web\u30c7\u30b6\u30a4\u30f3\u4e00\u5f0f", "\u6570\u91cf": 15, "\u5358\u4f4d": "\u500b", "\u5358\u4fa1": 8000 },\n      { "\u756a\u53f7": 2, "\u9805\u76ee": "\u30d0\u30ca\u30fc\u5236\u4f5c", "\u6570\u91cf": 5, "\u5358\u4f4d": "\u500b", "\u5358\u4fa1": 6000 }\n    ]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"templateBase64"})," (required): Base64-encoded Excel template"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"})," (required): Object with placeholder replacements"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sheetSelectBy"})," (optional): ",(0,r.jsx)(n.code,{children:'"id"'})," or ",(0,r.jsx)(n.code,{children:'"name"'})," (only effective when ",(0,r.jsx)(n.code,{children:"sheetSelectValue"})," is also provided)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sheetSelectValue"})," (optional): Sheet selector value (integer for ",(0,r.jsx)(n.code,{children:'"id"'}),", string for ",(0,r.jsx)(n.code,{children:'"name"'}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": "UEsDBBQABg..."\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response Fields:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"}),": Base64-encoded generated Excel file"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:3000/generate/excel \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "templateBase64": "UEsDBBQABg...",\n    "data": {\n      "\u4f1a\u793e\u540d": "\u30c6\u30b9\u30c8\u682a\u5f0f\u4f1a\u793e",\n      "\u65e5\u4ed8": "2025/12/13",\n      "\u91d1\u984d": "\xa51,234,567",\n      "\u62c5\u5f53\u8005": "\u5c71\u7530\u592a\u90ce"\n    },\n    "sheetSelectBy": "name",\n    "sheetSelectValue": "\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9\u8acb\u6c42\u66f8 \u5358\u4f4d\u3042\u308a 10\uff05 "\n  }\' \\\n  --output response.json\n\n# Extract and decode the file\ncat response.json | jq -r \'.data\' | base64 -d > output.xlsx\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Important Notes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Uses ",(0,r.jsx)(n.strong,{children:"test9 method"})," for normal placeholders (edits ",(0,r.jsx)(n.code,{children:"xl/sharedStrings.xml"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["If the template uses array placeholders like ",(0,r.jsx)(n.code,{children:"{{#\u660e\u7d30.\u9805\u76ee}}"})," (legacy), the server may also:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Insert rows into ",(0,r.jsx)(n.code,{children:"xl/worksheets/sheet1.xml"})," to fit array data"]}),"\n",(0,r.jsxs)(n.li,{children:["Update ",(0,r.jsx)(n.code,{children:"xl/workbook.xml"})," ",(0,r.jsx)(n.code,{children:"_xlnm.Print_Area"})," when rows overflow"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["If the template uses section-table placeholders like ",(0,r.jsx)(n.code,{children:"{{##\u8acb\u6c42.\u660e\u7d30.\u9805\u76ee}}"})," (recommended), the server:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Detects the target sheet dynamically (not fixed to ",(0,r.jsx)(n.code,{children:"sheet1.xml"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Treats the contiguous rows containing the same ",(0,r.jsx)(n.code,{children:"section.table"})," placeholders as one record block"]}),"\n",(0,r.jsx)(n.li,{children:"Duplicates the whole block per record and preserves style/merge-cells"}),"\n",(0,r.jsxs)(n.li,{children:["Auto-extends ",(0,r.jsx)(n.code,{children:"_xlnm.Print_Area"})," for the target sheet when rows overflow"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{{#...}}"})," and ",(0,r.jsx)(n.code,{children:"{{##...}}"})," cannot be mixed in the same template"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"7-generate-excel-by-display-order",children:"7. Generate Excel (By Display Order)"}),"\n",(0,r.jsx)(n.p,{children:"Generate Excel by selecting one sheet using display order (1-based)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /generate/excel/by-display-order"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "templateBase64": "UEsDBBQABg...",\n  "data": {\n    "\u4f1a\u793e\u540d": "\u30c6\u30b9\u30c8\u682a\u5f0f\u4f1a\u793e",\n    "\u65e5\u4ed8": "2025/12/13",\n    "\u91d1\u984d": "\xa51,234,567",\n    "\u62c5\u5f53\u8005": "\u5c71\u7530\u592a\u90ce"\n  },\n  "displayOrder": 1\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"templateBase64"})," (required): Base64-encoded Excel template"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"})," (required): Object with placeholder replacements"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"displayOrder"})," (required): 1-based sheet display order"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:3000/generate/excel/by-display-order \\\n  -H "Content-Type: application/json" \\\n  -H "X-API-Key: your-api-key-here" \\\n  -d \'{\n    "templateBase64": "UEsDBBQABg...",\n    "data": {\n      "\u4f1a\u793e\u540d": "\u30c6\u30b9\u30c8\u682a\u5f0f\u4f1a\u793e",\n      "\u65e5\u4ed8": "2025/12/13",\n      "\u91d1\u984d": "\xa51,234,567",\n      "\u62c5\u5f53\u8005": "\u5c71\u7530\u592a\u90ce"\n    },\n    "displayOrder": 1\n  }\'\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"8-generate-pdf",children:"8. Generate PDF"}),"\n",(0,r.jsx)(n.p,{children:"Generate PDF file from Excel template (requires LibreOffice)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /generate/pdf"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "templateBase64": "UEsDBBQABg...",\n  "data": {\n    "\u4f1a\u793e\u540d": "\u30c6\u30b9\u30c8\u682a\u5f0f\u4f1a\u793e",\n    "\u65e5\u4ed8": "2025/12/13",\n    "\u91d1\u984d": "\xa51,234,567",\n    "\u62c5\u5f53\u8005": "\u5c71\u7530\u592a\u90ce"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"templateBase64"})," (required): Base64-encoded Excel template"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"})," (required): Object with placeholder replacements"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sheetSelectBy"})," (optional): ",(0,r.jsx)(n.code,{children:'"id"'})," or ",(0,r.jsx)(n.code,{children:'"name"'})," (only effective when ",(0,r.jsx)(n.code,{children:"sheetSelectValue"})," is also provided)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sheetSelectValue"})," (optional): Sheet selector value (integer for ",(0,r.jsx)(n.code,{children:'"id"'}),", string for ",(0,r.jsx)(n.code,{children:'"name"'}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"options"})," (optional): PDF generation options (soffice command, timeout, etc.)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": "JVBERi0xLjQKJeLjz9..."\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response Fields:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"}),": Base64-encoded generated PDF file"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:3000/generate/pdf \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "templateBase64": "UEsDBBQABg...",\n    "data": {\n      "\u4f1a\u793e\u540d": "\u30c6\u30b9\u30c8\u682a\u5f0f\u4f1a\u793e",\n      "\u65e5\u4ed8": "2025/12/13",\n      "\u91d1\u984d": "\xa51,234,567",\n      "\u62c5\u5f53\u8005": "\u5c71\u7530\u592a\u90ce"\n    },\n    "sheetSelectBy": "id",\n    "sheetSelectValue": 1\n  }\' \\\n  --output response.json\n\n# Extract and decode the file\ncat response.json | jq -r \'.data\' | base64 -d > output.pdf\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"9-generate-pdf-by-display-order",children:"9. Generate PDF (By Display Order)"}),"\n",(0,r.jsx)(n.p,{children:"Generate PDF by selecting one sheet using display order (1-based)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /generate/pdf/by-display-order"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "templateBase64": "UEsDBBQABg...",\n  "data": {\n    "\u4f1a\u793e\u540d": "\u30c6\u30b9\u30c8\u682a\u5f0f\u4f1a\u793e",\n    "\u65e5\u4ed8": "2025/12/13",\n    "\u91d1\u984d": "\xa51,234,567",\n    "\u62c5\u5f53\u8005": "\u5c71\u7530\u592a\u90ce"\n  },\n  "displayOrder": 1,\n  "options": {\n    "timeout": 30000\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"templateBase64"})," (required): Base64-encoded Excel template"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"})," (required): Object with placeholder replacements"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"displayOrder"})," (required): 1-based sheet display order"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"options"})," (optional): PDF generation options (soffice command, timeout, etc.)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:3000/generate/pdf/by-display-order \\\n  -H "Content-Type: application/json" \\\n  -H "X-API-Key: your-api-key-here" \\\n  -d \'{\n    "templateBase64": "UEsDBBQABg...",\n    "data": {\n      "\u4f1a\u793e\u540d": "\u30c6\u30b9\u30c8\u682a\u5f0f\u4f1a\u793e",\n      "\u65e5\u4ed8": "2025/12/13",\n      "\u91d1\u984d": "\xa51,234,567",\n      "\u62c5\u5f53\u8005": "\u5c71\u7530\u592a\u90ce"\n    },\n    "displayOrder": 1\n  }\'\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Requirements:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"LibreOffice must be installed on the server"}),"\n",(0,r.jsxs)(n.li,{children:["Uses ",(0,r.jsx)(n.code,{children:"soffice"})," command-line tool"]}),"\n",(0,r.jsx)(n.li,{children:"First request may be slower due to LibreOffice initialization"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error Response (LibreOffice not installed):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "error": "LibreOffice is required for PDF generation but is not installed",\n  "details": "Please install LibreOffice: sudo apt-get install libreoffice"\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"error-responses-1",children:"Error Responses"}),"\n",(0,r.jsx)(n.p,{children:"All endpoints return errors in the following format:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "error": "Error message",\n  "details": "Detailed error description"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common HTTP Status Codes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"200"})," - Success"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"400"})," - Bad Request (missing required parameters)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"500"})," - Internal Server Error"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"503"})," - Service Unavailable (LibreOffice not installed)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"file-encoding",children:"File Encoding"}),"\n",(0,r.jsxs)(n.p,{children:["All file data is transmitted as ",(0,r.jsx)(n.strong,{children:"Base64-encoded strings"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"encoding-a-file-example-in-nodejs",children:"Encoding a file (example in Node.js):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const fs = require('fs');\nconst fileBuffer = fs.readFileSync('template.xlsx');\nconst templateBase64 = fileBuffer.toString('base64');\n"})}),"\n",(0,r.jsx)(n.h3,{id:"decoding-a-response-example-in-nodejs",children:"Decoding a response (example in Node.js):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const outputBuffer = Buffer.from(response.data, 'base64');\nfs.writeFileSync('output.xlsx', outputBuffer);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"encoding-a-file-example-in-python",children:"Encoding a file (example in Python):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import base64\n\nwith open('template.xlsx', 'rb') as f:\n    template_base64 = base64.b64encode(f.read()).decode('utf-8')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"decoding-a-response-example-in-python",children:"Decoding a response (example in Python):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import base64\n\noutput_data = base64.b64decode(response['data'])\nwith open('output.xlsx', 'wb') as f:\n    f.write(output_data)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"placeholder-format",children:"Placeholder Format"}),"\n",(0,r.jsx)(n.p,{children:"Placeholders in Excel templates should use the following format:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"{{placeholder_name}}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"array-table-placeholders",children:"Array (Table) placeholders"}),"\n",(0,r.jsx)(n.p,{children:"For table expansion, use:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"{{#ArrayName.field}}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{#\u660e\u7d30.\u756a\u53f7}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{#\u660e\u7d30.\u9805\u76ee}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{#\u660e\u7d30.\u6570\u91cf}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{#\u660e\u7d30.\u5358\u4f4d}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{#\u660e\u7d30.\u5358\u4fa1}}"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"section--table-placeholders-multi-row-block",children:"Section + Table placeholders (multi-row block)"}),"\n",(0,r.jsx)(n.p,{children:"For multi-row record expansion, use:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"{{##section.table.cell}}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{##\u8acb\u6c42.\u660e\u7d30.\u756a\u53f7}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{##\u8acb\u6c42.\u660e\u7d30.\u9805\u76ee}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{##\u8acb\u6c42.\u660e\u7d30.\u6570\u91cf}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{##\u8acb\u6c42.\u660e\u7d30.\u5358\u4fa1}}"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"JSON mapping (v1 endpoint compatible):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "\u8acb\u6c42": {\n      "\u660e\u7d30": [\n        { "\u756a\u53f7": 1, "\u9805\u76ee": "Web\u30c7\u30b6\u30a4\u30f3", "\u6570\u91cf": 2, "\u5358\u4fa1": 8000 },\n        { "\u756a\u53f7": 2, "\u9805\u76ee": "\u30d0\u30ca\u30fc\u5236\u4f5c", "\u6570\u91cf": 5, "\u5358\u4fa1": 6000 }\n      ]\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Rules:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Same ",(0,r.jsx)(n.code,{children:"section"})," cannot appear in multiple blocks in one template (error)"]}),"\n",(0,r.jsxs)(n.li,{children:["Rows for one ",(0,r.jsx)(n.code,{children:"section.table"})," block must be contiguous"]}),"\n",(0,r.jsx)(n.li,{children:"If data is shorter than template block count, remaining template block cells are cleared"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{\u4f1a\u793e\u540d}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{date}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{total_amount}}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"{{customer_name}}"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Important:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Placeholders are case-sensitive"}),"\n",(0,r.jsx)(n.li,{children:"Can contain Japanese characters, letters, numbers, and underscores"}),"\n",(0,r.jsxs)(n.li,{children:["Must be wrapped in double curly braces ",(0,r.jsx)(n.code,{children:"{{ }}"})]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"test9-method",children:"test9 Method"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"test9 method"})," is the core technology that preserves Excel print settings."]}),"\n",(0,r.jsx)(n.h3,{id:"how-it-works",children:"How it works:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Direct XML Manipulation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Unzips Excel file (XLSX is a ZIP archive)"}),"\n",(0,r.jsxs)(n.li,{children:["Directly edits ",(0,r.jsx)(n.code,{children:"xl/sharedStrings.xml"})]}),"\n",(0,r.jsx)(n.li,{children:"Replaces placeholder text in the XML"}),"\n",(0,r.jsx)(n.li,{children:"Re-zips the file"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why it's superior:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"100% preservation"})," of print settings"]}),"\n",(0,r.jsx)(n.li,{children:"Headers, footers, margins, page breaks all maintained"}),"\n",(0,r.jsx)(n.li,{children:"No library limitations (ExcelJS, xlsx, etc. lose settings)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Located in: ",(0,r.jsx)(n.code,{children:"src/lib/placeholderReplacer.ts"})]}),"\n",(0,r.jsx)(n.li,{children:"Uses: JSZip for ZIP manipulation"}),"\n",(0,r.jsxs)(n.li,{children:["Pattern: ",(0,r.jsx)(n.code,{children:"{{placeholder}}"})," detection via regex"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"multi-page-print-area-test13-like",children:"Multi-page Print Area (test13-like)"}),"\n",(0,r.jsxs)(n.p,{children:["If the template has a first print area (via ",(0,r.jsx)(n.code,{children:"xl/workbook.xml"})," ",(0,r.jsx)(n.code,{children:"_xlnm.Print_Area"}),") and content exceeds it:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The server appends the next print area with the same height."}),"\n",(0,r.jsxs)(n.li,{children:["Example (page height = 40 rows): ",(0,r.jsx)(n.code,{children:"$A$1:$Q$40"})," \u2192 ",(0,r.jsx)(n.code,{children:"$A$1:$Q$40,$A$41:$Q$80"})]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,r.jsx)(n.h3,{id:"cli-test-suite",children:"CLI Test Suite"}),"\n",(0,r.jsx)(n.p,{children:"Run automated tests:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm test\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Tests included:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Health check"}),"\n",(0,r.jsx)(n.li,{children:"Placeholder detection (simple)"}),"\n",(0,r.jsx)(n.li,{children:"Placeholder detection (detailed)"}),"\n",(0,r.jsx)(n.li,{children:"Template info"}),"\n",(0,r.jsx)(n.li,{children:"Excel generation"}),"\n",(0,r.jsx)(n.li,{children:"PDF generation"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"gui-test-client",children:"GUI Test Client"}),"\n",(0,r.jsx)(n.p,{children:"This project does not ship a Next.js UI."}),"\n",(0,r.jsxs)(n.p,{children:["Use the separate static test client in ",(0,r.jsx)(n.code,{children:"04_api-test-client"})," (served by ",(0,r.jsx)(n.code,{children:"http-server"}),")."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Features:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"File upload"}),"\n",(0,r.jsx)(n.li,{children:"Placeholder detection"}),"\n",(0,r.jsx)(n.li,{children:"Template info display"}),"\n",(0,r.jsx)(n.li,{children:"JSON data input"}),"\n",(0,r.jsx)(n.li,{children:"Excel/PDF generation"}),"\n",(0,r.jsx)(n.li,{children:"File download"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"development",children:"Development"}),"\n",(0,r.jsx)(n.h3,{id:"start-development-server-hot-reload",children:"Start development server (hot-reload):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm run dev\n"})}),"\n",(0,r.jsx)(n.h3,{id:"build-for-production",children:"Build for production:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm run build\n"})}),"\n",(0,r.jsx)(n.h3,{id:"start-production-server",children:"Start production server:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm start\n"})}),"\n",(0,r.jsx)(n.h3,{id:"initialize-libreoffice-for-pdf-generation",children:"Initialize LibreOffice (for PDF generation):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm run init-libreoffice\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"rate-limits",children:"Rate Limits"}),"\n",(0,r.jsxs)(n.p,{children:["Currently ",(0,r.jsx)(n.strong,{children:"no rate limits"})," are implemented."]}),"\n",(0,r.jsx)(n.p,{children:"For production use, consider adding:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Rate limiting middleware (express-rate-limit)"}),"\n",(0,r.jsx)(n.li,{children:"Authentication (JWT)"}),"\n",(0,r.jsx)(n.li,{children:"Request size limits (already set to 50MB)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"cors",children:"CORS"}),"\n",(0,r.jsx)(n.p,{children:"CORS is enabled for all origins:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"app.use(cors());\n"})}),"\n",(0,r.jsx)(n.p,{children:"For production, restrict to specific origins:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"app.use(cors({\n  origin: 'https://yourdomain.com'\n}));\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"support",children:"Support"}),"\n",(0,r.jsx)(n.p,{children:"For issues or questions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["GitHub: ",(0,r.jsx)(n.a,{href:"https://github.com/nodenberg/nodenberg",children:"https://github.com/nodenberg/nodenberg"})]}),"\n",(0,r.jsx)(n.li,{children:"Documentation: This file (API.md)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"version",children:"Version"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Current Version:"})," 0.0.1"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Last Updated:"})," 2025-12-13"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453(e,n,s){s.d(n,{R:()=>d,x:()=>t});var l=s(6540);const r={},i=l.createContext(r);function d(e){const n=l.useContext(i);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),l.createElement(i.Provider,{value:n},e.children)}}}]);